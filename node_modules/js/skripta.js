function DajSinglePolicajac(link){
    location.href=link;
}
function ModalRegistracija(idVozila,nazivVozila){
    $("#voziloID").val(idVozila);
    $("#nazivVozila").html(nazivVozila);
    $("#ModalRegistracija").modal("show");
}

function ModalUnaprijediPolicajca(){
    var cin=$("#selectCinovi").find(":selected").text();
    $("#cin").append(cin);
    $("#modalPotvrdaUnaprijedi").modal("show");
}

function DohvatiSelectData(idPolicajca){
    var idPolicajcaJson=`idPolicajca=${idPolicajca}&action=selectPolicajci`;
    $.ajax({
    type: "post",
    url: 'http://localhost/wordpress/wp-admin/admin-ajax.php',
    data: idPolicajcaJson,
    success: function(data){
        if($('#formUnaprijedi select').length>0){
            $('#formUnaprijedi select').remove();
        }
        $("#formUnaprijedi").append(data);
        $("#modalUnaprijedi").modal("show");
    }
    });
}

function DajSelectCinovi(idPolicajca){
    $("#idPolicajca").val(idPolicajca);
    $("#vrstaSluzbeSelect").val("");
    $("#selectCinovi").remove();
    $("#modalUnaprijedi").modal("show");
}

function UnaprijediPolicajca(){
    var vrstaSluzbe=$("#vrstaSluzbeSelect option:selected").val();
    var cin=$("#selectCinovi option:selected").val();
    var idPolicajca=$("#idPolicajca").val();
    var id=`idPolicajca=${idPolicajca}&vrstaSluzbe=${vrstaSluzbe}&cin=${cin}&action=updatePolicajca`;
    $.ajax({
        type: "post",
        url: 'http://localhost/wordpress/wp-admin/admin-ajax.php',
        data: id,
        success: function(data){
            location.reload();
        }
        });
}

function RegistrirajVozilo(){
    var idVozila=$("#voziloID").val();
    var id=`idVozila=${idVozila}&action=updateVozilo`;
    $("#tableVozila").DataTable().clear().destroy();
    $.ajax({
    type: "post",
    url: 'http://localhost/wordpress/wp-admin/admin-ajax.php',
    data: id,
    success: function(data){
        $("#divVozila").empty();
        $("#divVozila").html(data);
        $("#tostDodavanje").toast("show");
        $("#ModalRegistracija").modal("hide");
        InitDatatableVozila();
    }
    });
}

function InitDatatableVozila(){
    $("#tableVozila tbody tr .datumRegistracije").each(function(index){
        var datumRegistracije=new Date(this.attributes[1].nodeValue);
        var year = datumRegistracije.getFullYear();
        var month = datumRegistracije.getMonth();
        var day = datumRegistracije.getDate();
        var datumRegistracijeIstek = new Date(year+1, month, day);
        var today=new Date();
        var istekGodina=datumRegistracijeIstek.getFullYear();
        var istekMjesec=datumRegistracijeIstek.getMonth();
        var istekDan=datumRegistracijeIstek.getDay();
        var rokPrijeIsteka=new Date(istekGodina,istekMjesec-1,istekDan);
        if(datumRegistracijeIstek<today && datumRegistracije<rokPrijeIsteka){
            $("#tableVozila tbody tr:nth-child("+ ++index +")").css("background","#e63946");
            $("#tableVozila tbody tr").eq(--index).find("button").prop("disabled",false);
        }
        else if(datumRegistracijeIstek>today && rokPrijeIsteka<=today){
            $("#tableVozila tbody tr:nth-child("+ ++index +")").css("background","#4BB543");
            $("#tableVozila tbody tr").eq(--index).find("button").prop("disabled",false);
        }
        else{
            $("#tableVozila tbody tr:nth-child("+ ++index +")").css("background","#4BB543");
            $("#tableVozila tbody tr").eq(--index).find("button").prop("disabled",true);
        }
        });
}
